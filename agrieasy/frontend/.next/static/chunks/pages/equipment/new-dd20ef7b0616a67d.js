(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[298],{1821:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/equipment/new",function(){return t(7174)}])},7174:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return i}});var l=t(5893),r=t(7294),n=t(3700),u=t(8937);function i(){let{token:e,user:a}=(0,n.a)(),[t,i]=(0,r.useState)(""),[o,s]=(0,r.useState)(""),[d,c]=(0,r.useState)(1e3),[m,p]=(0,r.useState)(null),[f,h]=(0,r.useState)(null),[b,w]=(0,r.useState)(!1),g=async()=>{if(!m)return null;let a=new FormData;a.append("image",m);try{return(await (0,u.h)("/equipment/upload-image",{method:"POST",body:a},e)).imageUrl}catch(e){return alert("Image upload failed"),null}},N=async()=>{if(!e)return alert("Login required");if((null==a?void 0:a.role)!=="EQUIPMENT_VENDOR")return alert("Vendor role required");w(!0);let l=await g();if(!l&&m){w(!1);return}try{await (0,u.h)("/equipment",{method:"POST",body:JSON.stringify({name:t,description:o,pricePerDay:d,imageUrl:l})},e),alert("Equipment created"),i(""),s(""),c(1e3),p(null),h(null)}catch(e){alert("Failed to create equipment")}finally{w(!1)}};return(0,l.jsxs)("div",{className:"max-w-md mx-auto bg-white p-6 rounded shadow",children:[(0,l.jsx)("h1",{className:"text-xl font-semibold mb-4",children:"Upload Equipment"}),(0,l.jsx)("input",{className:"border p-2 w-full mb-3",placeholder:"Name",value:t,onChange:e=>i(e.target.value)}),(0,l.jsx)("textarea",{className:"border p-2 w-full mb-3",placeholder:"Description",value:o,onChange:e=>s(e.target.value)}),(0,l.jsx)("input",{type:"number",className:"border p-2 w-full mb-3",placeholder:"Price Per Day",value:d,onChange:e=>c(Number(e.target.value))}),(0,l.jsx)("input",{type:"file",accept:"image/*",className:"border p-2 w-full mb-3",onChange:e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(t){p(t);let e=new FileReader;e.onload=()=>h(e.result),e.readAsDataURL(t)}}}),f&&(0,l.jsx)("img",{src:f,alt:"Preview",className:"w-full h-48 object-cover mb-3 rounded"}),(0,l.jsx)("button",{onClick:N,disabled:b,className:"px-4 py-2 rounded w-full ".concat(b?"bg-gray-400":"bg-primary-green text-white"),children:b?"Creating...":"Create"})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=1821)}),_N_E=e.O()}]);