(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[649],{7906:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/inputs/new",function(){return a(4568)}])},4568:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var l=a(5893),r=a(7294),n=a(3700),u=a(8937);function i(){let{token:e,user:t}=(0,n.a)(),[a,i]=(0,r.useState)(""),[o,s]=(0,r.useState)("FERTILIZER"),[d,c]=(0,r.useState)(500),[p,m]=(0,r.useState)(10),[h,f]=(0,r.useState)(null),[b,g]=(0,r.useState)(null),[w,E]=(0,r.useState)(!1),v=async()=>{if(!h)return null;let t=new FormData;t.append("image",h);try{return(await (0,u.h)("/inputs/upload-image",{method:"POST",body:t},e)).imageUrl}catch(e){return alert("Image upload failed"),null}},N=async()=>{if(!e)return alert("Login required");if((null==t?void 0:t.role)!=="INPUT_SUPPLIER")return alert("Input Supplier role required");E(!0);let l=await v();if(!l&&h){E(!1);return}try{await (0,u.h)("/inputs",{method:"POST",body:JSON.stringify({name:a,category:o,price:d,stock:p,imageUrl:l})},e),alert("Input product created"),i(""),s("FERTILIZER"),c(500),m(10),f(null),g(null)}catch(e){alert("Failed to create product")}finally{E(!1)}};return(0,l.jsxs)("div",{className:"max-w-md mx-auto bg-white p-6 rounded shadow",children:[(0,l.jsx)("h1",{className:"text-xl font-semibold mb-4",children:"Add Input Product"}),(0,l.jsx)("input",{className:"border p-2 w-full mb-3",placeholder:"Name",value:a,onChange:e=>i(e.target.value)}),(0,l.jsxs)("select",{className:"border p-2 w-full mb-3",value:o,onChange:e=>s(e.target.value),children:[(0,l.jsx)("option",{value:"FERTILIZER",children:"FERTILIZER"}),(0,l.jsx)("option",{value:"PESTICIDE",children:"PESTICIDE"}),(0,l.jsx)("option",{value:"OTHER",children:"OTHER"})]}),(0,l.jsx)("input",{type:"number",className:"border p-2 w-full mb-3",placeholder:"Price",value:d,onChange:e=>c(Number(e.target.value))}),(0,l.jsx)("input",{type:"number",className:"border p-2 w-full mb-3",placeholder:"Stock",value:p,onChange:e=>m(Number(e.target.value))}),(0,l.jsx)("input",{type:"file",accept:"image/*",className:"border p-2 w-full mb-3",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){f(a);let e=new FileReader;e.onload=()=>g(e.result),e.readAsDataURL(a)}}}),b&&(0,l.jsx)("img",{src:b,alt:"Preview",className:"w-full h-48 object-cover mb-3 rounded"}),(0,l.jsx)("button",{onClick:N,disabled:w,className:"px-4 py-2 rounded w-full ".concat(w?"bg-gray-400":"bg-primary-green text-white"),children:w?"Creating...":"Create"})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=7906)}),_N_E=e.O()}]);