(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{4476:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return r(160)}])},160:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(5893),s=r(7294),i=r(8937),c=r(3700),n=r(1163);function l(){let[e,t]=(0,s.useState)([]),[r,l]=(0,s.useState)(!0),{token:d}=(0,c.a)(),o=(0,n.useRouter)(),m=async()=>{if(!d){l(!1);return}try{let e=await (0,i.h)("/cart",{},d),r=await Promise.all((e||[]).map(async e=>{try{let t;if("PRODUCE"===e.itemType)t=await (0,i.h)("/produce/".concat(e.itemId),{},d);else{if("INPUT"!==e.itemType)return e;t=await (0,i.h)("/inputs/".concat(e.itemId),{},d)}return{...e,product:t}}catch(t){return console.error("Failed to fetch product details for",e.itemType,e.itemId,t),e}}));t(r)}catch(e){console.error("Failed to load cart:",e)}l(!1)};(0,s.useEffect)(()=>{m()},[d]);let x=async(e,t)=>{if(t<=0){await u(e);return}await (0,i.h)("/cart/".concat(e),{method:"PATCH",body:JSON.stringify({quantity:t})},d),m()},u=async e=>{await (0,i.h)("/cart/".concat(e),{method:"DELETE"},d),m()},h=async()=>{if(!d)return alert("Login required");try{let e=await (0,i.h)("/orders/checkout",{method:"POST"},d);o.push("/orders/".concat(e.id))}catch(e){alert("Failed to create order. Please try again.")}};return d?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Shopping Cart"}),r?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading cart..."})]}):0===e.length?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6m8 0V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4.01"})}),(0,a.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Your cart is empty"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"Start shopping to add items to your cart."}),(0,a.jsx)("button",{onClick:()=>o.push("/produce"),className:"mt-4 bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700",children:"Browse Products"})]})}):(0,a.jsxs)("div",{className:"space-y-4",children:[e.map(e=>{var t,r,s,i,c;return(0,a.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(null===(t=e.product)||void 0===t?void 0:t.imageUrl)&&(0,a.jsx)("img",{src:e.product.imageUrl,alt:e.product.name,className:"w-20 h-20 object-cover rounded-lg"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:(null===(r=e.product)||void 0===r?void 0:r.name)||"".concat(e.itemType," Item")}),(0,a.jsx)("p",{className:"text-gray-600",children:(null===(s=e.product)||void 0===s?void 0:s.category)&&"Category: ".concat(e.product.category)}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Unit Price: ₹",parseFloat((null===(i=e.product)||void 0===i?void 0:i.price)||0).toFixed(2)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>x(e.id,e.quantity-1),className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300",children:"−"}),(0,a.jsx)("span",{className:"w-12 text-center font-medium",children:e.quantity}),(0,a.jsx)("button",{onClick:()=>x(e.id,e.quantity+1),className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300",children:"+"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["₹",((parseFloat(null===(c=e.product)||void 0===c?void 0:c.price)||0)*e.quantity).toFixed(2)]}),(0,a.jsx)("button",{onClick:()=>u(e.id),className:"text-red-600 text-sm hover:text-red-800",children:"Remove"})]})]})]})},e.id)}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Cart Summary"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-gray-900",children:["₹",e.reduce((e,t)=>{var r;return e+(parseFloat(null===(r=t.product)||void 0===r?void 0:r.price)||0)*t.quantity},0).toFixed(2)]})]}),(0,a.jsx)("button",{onClick:h,className:"w-full bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors",children:"Proceed to Checkout"})]})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Shopping Cart"}),(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow",children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Please login to view your cart."}),(0,a.jsx)("button",{onClick:()=>o.push("/login"),className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700",children:"Login"})]})]})})})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=4476)}),_N_E=e.O()}]);